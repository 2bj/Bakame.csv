<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Writing to CSV - Bakame.Csv</title>
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Exo+2:400,500,700,700italic,500italic,400italic|Noticia+Text:400,400italic,700,700italic">
<link rel="stylesheet" href="assets/normalize.css">
<link rel="stylesheet" href="assets/prism.css">
<link rel="stylesheet" href="assets/screen.css">
</head>
<body>
<header role="banner">
	<h1>Bakame.csv</h1>
	<p class="tagline">Csv data manipulation made easy in PHP</p>
</header>
<main>
	<menu>
		<h2>Getting Started</h2>
		<ul>
			<li><a href="index.html">Introduction</a></li>
			<li><a href="examples.html">Examples</a></li>
			<li><a href="installation.html">Installation</a></li>
		</ul>
		<h2>The API</h2>
		<ul>
            <li><a href="loading.html">Loading a CSV</a></li>
            <li><a href="conversion.html">Outputting a CSV</a></li>
			<li><a href="reading.html">Reading a CSV</a></li>
			<li class="selected"><a href="writing.html">Writing a CSV</a></li>
		</ul>
	</menu>
	<article>
<h1>Inserting data into the CSV</h1>
<p>To create or update a CSV use the following specific <code>Bakame\Csv\Writer</code> methods.</p>

<p class="message-warning">When inserting strings don't forget to specify the CSV delimiter and enclosure characters that match those use in the string.</p>

<p class="message-info">When creating a file using the library, first insert all the data that need to be inserted before starting manipulating the CSV. If you manipulate your data before insertion, you may change the file cursor position and get unexpected results.</p>

<h3>insertOne</h3>
<p><code>insertOne</code> inserts a single row. This method can take an <code>array</code>, a <code>string</code> or an <code>object</code> implementing the <code>__toString</code> method.</p>
<pre><code class="language-php">class ToStringEnabledClass
{
    private $str;

    public function __construct($str)
    {
        $this-&gt;str = $str;
    }

    public function __toString()
    {
        return $this-&gt;str;
    }
}

$writer-&gt;insertOne(['john', 'doe', 'john.doe@example.com']);
$writer-&gt;insertOne(&quot;'john','doe','john.doe@example.com'&quot;); 
$writer-&gt;insertOne(new ToStringEnabledClass(&quot;john,doe,john.doe@example.com&quot;)) 
</code></pre>
<h3>insertAll</h3>
<p><code>insertAll</code> inserts multiple rows. This method can take an <code>array</code> or a <code>Traversable</code> object to add several rows to the CSV data.</p>
<pre><code class="language-php">$arr = [
    [1, 2, 3],
    ['foo', 'bar', 'baz'],
    &quot;'john','doe','john.doe@example.com'&quot;,
    new ToStringEnabledClass(&quot;john,doe,john.doe@example.com&quot;)
];

$writer-&gt;insertAll($arr) //using an array 

$object = new ArrayIterator($arr);
$writer-&gt;insertAll($object); //using a Traversable object
</code></pre>



	</article>
</main>
<footer role="contentinfo">
<div>
<p>Bakame.csv is a library coded by <a href="https://github.com/nyamsprod">Nyamagana Butera Ignace</a>.You can contact me using:</p>
<ul>
<li><a href="https://twitter.com/intent/user?screen_name=nyamsprod" target="_blank" title="Follow @nyamsprod on twitter">Twitter</a>
<li><a href="https://www.facebook.com/nyamsprod" target="_blank" title="Join me on facebook">Facebook</a>
<li><a href="http://be.linkedin.com/pub/ignace-philippe-nyamagana-butera/13/a16/6b4" title="Connect with me through LinkedIn">LinkedIn</a>
<li><a href="https://plus.google.com/103435977218171777746/?rel=author" target="_blank" title="Find Nyamsprod on Google+" rel="author">Google+</a>
</ul>
<p class="copyrights">
&copy; Nyamagana Butera Ignace. Site design by  <a href="https://www.nyamsprod.com">Nyamagana Butera Ignace</a><br>
crafted with <strong>Love</strong>, <strong>Passion</strong> and
<a target="_blank" rel="external" href="http://www.vim.org/">Vim</a>.<br>
The site is always rendered using <a target="_blank" rel="external" href="http://www.w3.org/">Open Web Technologies</a>
</p>
</div>
</footer><!-- End Footer -->
<script src="assets/prism.js"></script>
<script>
var _gaq=[["_setAccount","UA-1200654-1"],["_trackPageview"]], ___gcfg = {lang: 'en'};
(function(d, t){
    var g = d.createElement(t),o = d.getElementsByTagName(t)[0];
        g.src = ('https' == d.location.protocol) ? 'https://ssl.google-analytics.com/ga.js' : 'http://www.google-analytics.com/ga.js';
        g.async = 1;
        o.parentNode.insertBefore(g, o);
})(document, 'script');
</script>
</body>
</html>
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Loading a CSV document - Bakame.Csv</title>
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Exo+2:400,500,700,700italic,500italic,400italic|Noticia+Text:400,400italic,700,700italic">
<link rel="stylesheet" href="assets/normalize.css">
<link rel="stylesheet" href="assets/prism.css">
<link rel="stylesheet" href="assets/screen.css">
</head>
<body>
<header role="banner">
	<h1>Bakame.csv</h1>
	<p class="tagline">Csv data manipulation made easy in PHP</p>
</header>
<main>
	<menu>
		<h2>Getting Started</h2>
		<ul>
			<li><a href="index.html">Introduction</a></li>
			<li><a href="examples.html">Examples</a></li>
			<li><a href="installation.html">Installation</a></li>
		</ul>
		<h2>The API</h2>
		<ul>
            <li class="selected"><a href="loading.html">Loading a CSV</a></li>
            <li><a href="conversion.html">Outputting a CSV</a></li>
			<li><a href="reading.html">Reading a CSV</a></li>
			<li><a href="writing.html">Writing a CSV</a></li>
		</ul>
	</menu>
	<article>
<h1>Loading a CSV</h1>

<div class="message-warning"><strong>If you are on a Mac OS X Server</strong>, add the following lines before using the library to help <a href="http://php.net/manual/en/function.fgetcsv.php#refsect1-function.fgetcsv-returnvalues">PHP detect line ending in Mac OS X</a>.
<pre><code class="language-php">if (! ini_get(&quot;auto_detect_line_endings&quot;)) {
    ini_set(&quot;auto_detect_line_endings&quot;, true);
}
</code></pre>
</div>

<p class="message-info">If you have your LC_CTYPE set to a locale that's using UTF-8 and you try to parse a file that's not in UTF-8, PHP will cut your fields the moment it encounters a byte it can't understand (i.e. any outside of ASCII that doesn't happen to be part of a UTF-8 character which it likely isn't). <a href="https://gist.github.com/pilif/9137146">This gist will show you a possible solution</a> to this problem by using <a href="http://www.php.net/manual/en/stream.filters.php">PHP stream filter</a>. This tip is from <a href="https://github.com/pilif">Philip Hofstetter</a></p>

<p>The library is composed of two main classes:</p>

<ul>
<li><code>Bakame\Csv\Reader</code> to extract and filter data from a CSV</li>
<li><code>Bakame\Csv\Writer</code> to insert new data into a CSV.</li>
</ul>

<p>Both classes share methods to instantiate, format and output the CSV.</p>
<p>There's several ways to instantiate these classes:</p>
<pre><code class="language-php">use Bakame\Csv\Reader;
use Bakame\Csv\Writer;

$reader = new Reader('/path/to/your/csv/file.csv');
$reader = new Reader(new SpliFileInfo('/path/to/your/csv/file.csv'), 'rt');
$reader = Reader::createFromString('john,doe,john.doe@example.com');

//or 

$writer = new Writer('/path/to/your/csv/file.csv', 'ab+');
$writer = new Writer(new SpliFileObject('/path/to/your/csv/file.csv'));
$writer = Writer::createFromString('john,doe,john.doe@example.com');
</code></pre>

<p>Both classes constructors take one optional parameter <code>$open_mode</code> representing the file open mode used by the PHP <a href="http://php.net/manual/en/function.fopen.php">fopen</a> function.</p>
<p>The <code>$open_mode</code> parameter is taken into account if you instantiate your object with:</p>
<ul>
<li>a <code>SplFileInfo</code></li>
<li>a string path</li>
</ul>
<p>The <code>$open_mode</code> parameter is <strong>ignore</strong> if you instantiate your object with:</p>
<ul>
<li>a <code>SplFileObject</code></li>
<li>a <code>SplTempFileObject</code></li>
</ul>
<p>When not explicitly set:</p>
<ul>
<li>The <code>Bakame\Csv\Writer</code> <code>$open_mode</code> default value is <code>w</code>.</li>
<li>The <code>Bakame\Csv\Reader</code> <code>$open_mode</code> default value is <code>r</code>.</li>
</ul>
<p>The static method <code>createFromString</code> is to be use if your data is a string. This method takes no optional <code>$open_mode</code> parameter.</p>
<p>Once your object is created you can optionally set:</p>
<ul>
<li>the CSV delimiter, enclosure and/or escape characters;</li>
<li>the object <code>SplFileObject</code> flags;</li>
<li>the CSV encoding charset if the CSV is not in <code>UTF-8</code>;</li>
</ul>
<pre><code class="language-php">$reader = new Reader('/path/to/your/csv/file.csv');

$reader-&gt;setDelimeter(',');
$reader-&gt;setEnclosure('&quot;');
$reader-&gt;setEscape('\\');
$reader-&gt;setFlags(SplFileObject::READ_AHEAD|SplFileObject::SKIP_EMPTY);
$reader-&gt;setEncoding('iso-8859-1');
</code></pre>

<h2>Switching from one class to the other</h2>
<p>It is possible to switch between modes by using:</p>
<ul>
<li>the <code>Bakame\Csv\Writer::getReader</code> method from the <code>Bakame\Csv\Writer</code> class</li>
<li>the <code>Bakame\Csv\Reader::getWriter</code> method from the <code>Bakame\Csv\Reader</code> class this method accept the optional <code>$open_mode</code> parameter.</li>
</ul>
<pre><code class="language-php">$reader = $writer-&gt;getReader();
$newWriter = $reader-&gt;getWriter('a'); 
</code></pre>

<p class="message-warning"><strong>warning:</strong> be careful the <code>$newWriter</code> object is not equal to the <code>$writer</code> object!!</p>
	</article>
</main>
<footer role="contentinfo">
<div>
<p>Bakame.csv is a library coded by <a href="https://github.com/nyamsprod">Nyamagana Butera Ignace</a>.You can contact me using:</p>
<ul>
<li><a href="https://twitter.com/intent/user?screen_name=nyamsprod" target="_blank" title="Follow @nyamsprod on twitter">Twitter</a>
<li><a href="https://www.facebook.com/nyamsprod" target="_blank" title="Join me on facebook">Facebook</a>
<li><a href="http://be.linkedin.com/pub/ignace-philippe-nyamagana-butera/13/a16/6b4" title="Connect with me through LinkedIn">LinkedIn</a>
<li><a href="https://plus.google.com/103435977218171777746/?rel=author" target="_blank" title="Find Nyamsprod on Google+" rel="author">Google+</a>
</ul>
<p class="copyrights">
&copy; Nyamagana Butera Ignace. Site design by  <a href="https://www.nyamsprod.com">Nyamagana Butera Ignace</a><br>
crafted with <strong>Love</strong>, <strong>Passion</strong> and
<a target="_blank" rel="external" href="http://www.vim.org/">Vim</a>.<br>
The site is always rendered using <a target="_blank" rel="external" href="http://www.w3.org/">Open Web Technologies</a>
</p>
</div>
</footer><!-- End Footer -->
<script src="assets/prism.js"></script>
<script>
var _gaq=[["_setAccount","UA-1200654-1"],["_trackPageview"]], ___gcfg = {lang: 'en'};
(function(d, t){
    var g = d.createElement(t),o = d.getElementsByTagName(t)[0];
        g.src = ('https' == d.location.protocol) ? 'https://ssl.google-analytics.com/ga.js' : 'http://www.google-analytics.com/ga.js';
        g.async = 1;
        o.parentNode.insertBefore(g, o);
})(document, 'script');
</script>
</body>
</html>